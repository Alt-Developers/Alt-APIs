// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                 String      @id @default(uuid())
  username           String      @unique
  firstname          String
  lastname           String
  email              String      @unique
  password           String
  createdAt          DateTime    @default(now())
  updatedAt          DateTime    @default(now())
  primaryTimetable   Timetable?  @relation(name: "members", fields: [primaryTimetableId], references: [id])
  primaryTimetableId String?
  createdTimetables  Timetable[] @relation("created")
  Timetable          Timetable?  @relation(fields: [timetableId], references: [id])
  timetableId        String?
}

model Timetable {
  id                String    @id @default(uuid())
  name              String    @unique
  description       String
  upvotes           Int       @default(0)
  subjects          Subject[]
  mondaySubjects    Subject[] @relation(name: "monday")
  tuesdaySubjects   Subject[] @relation(name: "tuesday")
  wednesdaySubjects Subject[] @relation(name: "wednesday")
  thursdaySubjects  Subject[] @relation(name: "thursday")
  fridaySubjects    Subject[] @relation(name: "friday")
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @default(now())
  createdBy         User      @relation(name: "created", fields: [creatorId], references: [id])
  creatorId         String
  members           User[]    @relation(name: "members")
  User              User[]
}

model Subject {
  id          String      @id @default(uuid())
  name        String      @unique
  emoji       String
  color       String
  Timetable   Timetable?  @relation(fields: [timetableId], references: [id])
  timetableId String?
  monday      Timetable[] @relation(name: "monday")
  tuesday     Timetable[] @relation(name: "tuesday")
  wednesday   Timetable[] @relation(name: "wednesday")
  thursday    Timetable[] @relation(name: "thursday")
  friday      Timetable[] @relation(name: "friday")
}
